#!/bin/csh -f
#
# diff for prokov tests
# (avoid errors due to rounding floats)

if ($#argv != 2) exit 1

if (! -e $1) exit 3
if (! -e $2) exit 3

sed -e 's/\.\(..\)[0-4][0-9]*/\.\1/g' $1 |\
sed -e 's/\.\(.\)0[5-9][0-9]*/\.\11/g'   |\
sed -e 's/\.\(.\)1[5-9][0-9]*/\.\12/g'   |\
sed -e 's/\.\(.\)2[5-9][0-9]*/\.\13/g'   |\
sed -e 's/\.\(.\)3[5-9][0-9]*/\.\14/g'   |\
sed -e 's/\.\(.\)4[5-9][0-9]*/\.\15/g'   |\
sed -e 's/\.\(.\)5[5-9][0-9]*/\.\16/g'   |\
sed -e 's/\.\(.\)6[5-9][0-9]*/\.\17/g'   |\
sed -e 's/\.\(.\)7[5-9][0-9]*/\.\18/g'   |\
sed -e 's/\.\(.\)8[5-9][0-9]*/\.\19/g'   |\
sed -e 's/\.09[5-9][0-9]*/\.10/g'   |\
sed -e 's/\.19[5-9][0-9]*/\.20/g'   |\
sed -e 's/\.29[5-9][0-9]*/\.30/g'   |\
sed -e 's/\.39[5-9][0-9]*/\.40/g'   |\
sed -e 's/\.49[5-9][0-9]*/\.50/g'   |\
sed -e 's/\.59[5-9][0-9]*/\.60/g'   |\
sed -e 's/\.69[5-9][0-9]*/\.70/g'   |\
sed -e 's/\.79[5-9][0-9]*/\.80/g'   |\
sed -e 's/\.89[5-9][0-9]*/\.90/g'   |\
sed -e 's/0\.99[5-9][0-9]*/1\.00/g' > 1_$$

sed -e 's/\.\(..\)[0-4][0-9]*/\.\1/g' $2 |\
sed -e 's/\.\(.\)0[5-9][0-9]*/\.\11/g'   |\
sed -e 's/\.\(.\)1[5-9][0-9]*/\.\12/g'   |\
sed -e 's/\.\(.\)2[5-9][0-9]*/\.\13/g'   |\
sed -e 's/\.\(.\)3[5-9][0-9]*/\.\14/g'   |\
sed -e 's/\.\(.\)4[5-9][0-9]*/\.\15/g'   |\
sed -e 's/\.\(.\)5[5-9][0-9]*/\.\16/g'   |\
sed -e 's/\.\(.\)6[5-9][0-9]*/\.\17/g'   |\
sed -e 's/\.\(.\)7[5-9][0-9]*/\.\18/g'   |\
sed -e 's/\.\(.\)8[5-9][0-9]*/\.\19/g'   |\
sed -e 's/\.09[5-9][0-9]*/\.10/g'   |\
sed -e 's/\.19[5-9][0-9]*/\.20/g'   |\
sed -e 's/\.29[5-9][0-9]*/\.30/g'   |\
sed -e 's/\.39[5-9][0-9]*/\.40/g'   |\
sed -e 's/\.49[5-9][0-9]*/\.50/g'   |\
sed -e 's/\.59[5-9][0-9]*/\.60/g'   |\
sed -e 's/\.69[5-9][0-9]*/\.70/g'   |\
sed -e 's/\.79[5-9][0-9]*/\.80/g'   |\
sed -e 's/\.89[5-9][0-9]*/\.90/g'   |\
sed -e 's/0\.99[5-9][0-9]*/1\.00/g' > 2_$$

diff 1_$$ 2_$$

set stat = $status

#
# fin
#

fin:

\rm -f ?_$$

exit $stat
